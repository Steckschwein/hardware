*=$1000

!src <defs.h.a>
!src <bios.h.a>
!src <via.h.a>

    sei
-	
	jsr .kbd_enable	
	jsr spi_r_byte
	jsr .kbd_disable
	cmp #$00
	beq -
	cmp #$1b
	bne +

	jsr .kbd_enable	
	jsr spi_r_byte
	jsr .kbd_disable
	cmp #'A'
	bne ++
	lda #'U'
	jsr chrout
	bra -
++	cmp #'B'
	bne ++

	lda #'D'
	jsr chrout
	bra -

++	cmp #'C'
	bne ++

	lda #'R'
	jsr chrout
	bra -


++	cmp #'D'
	bne +

	lda #'L'
	jsr chrout
	bra -


+
	jsr hexout
    ;+Println
 	bra -

.kbd_enable
	lda #%01111010
	sta via1portb
	rts

.kbd_disable
	; disable keyboard
	ldx #$7e
	stx via1portb	
	rts

.kbd_chrin
	lda #%01111010
	sta via1portb

	jsr .kbd_enable
; -	lda #$00
	jsr spi_r_byte

	ldx #$7e
	stx via1portb	

	
	rts
	
